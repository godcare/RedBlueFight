{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Game5/assets\\Scripts\\Control\\Games\\Game5\\Game5Control.js"],"names":["SoundManager","require","cc","Class","extends","Component","properties","SoundMGR","default","type","GameResultNode","Node","CountDownNode","PauseNode","AllBalls","AllPans","PlacedBalls","PlacedPans","RedCount","BlueCount","PinchDistance","TouchableBalls","GameStatus","start","startAnimation","scheduleOnce","active","i","length","name","onTouchStart","playVoice","onEndMove","movedBall","log","ball","find","j","tmpJ","indexOf","toString","dist","Math","floor","sqrt","pow","x","y","substr","push","replace","bm","moveTo","position","playBlob","runAction","ShowResult","winner","playOver","sa","scaleTo","sr","rotateBy","Global","GameData","CurrentWinner"],"mappings":"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","file":"Game5Control.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Game5","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n// var GameDragMove = require(\"Game5DragMove\");\r\nvar SoundManager = require(\"SoundManager\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        SoundMGR:\r\n        {\r\n            default: null,\r\n            type: SoundManager,\r\n        },\r\n        GameResultNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        CountDownNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        PauseNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        AllBalls:\r\n        {\r\n            default: [],\r\n            type: [cc.Node],\r\n        },\r\n        AllPans:\r\n        {\r\n            default: [],\r\n            type: [cc.Node],\r\n        },\r\n        PlacedBalls:\r\n        {\r\n            default: [],\r\n        },\r\n\r\n        PlacedPans:\r\n        {\r\n            default: [],\r\n        },\r\n        RedCount: 0,\r\n        BlueCount: 0,\r\n        PinchDistance: 60,//吸入的距离\r\n        TouchableBalls: \"\",\r\n        GameStatus: 0,//0未开始，1开始了，2结束了\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        this.startAnimation();\r\n    },\r\n\r\n    startAnimation() {\r\n        this.scheduleOnce(function () {\r\n            this.CountDownNode.active = true;\r\n        }, 0.5)\r\n        this.scheduleOnce(function () {\r\n            for (var i = 0; i < this.AllBalls.length; i++) {\r\n                this.TouchableBalls += this.AllBalls[i].name;\r\n            }\r\n            this.GameStatus = 1;\r\n            this.PauseNode.active = true;\r\n\r\n        }, 4.5);\r\n\r\n    },\r\n    onTouchStart() {\r\n        this.SoundMGR.playVoice();\r\n\r\n    },\r\n    onEndMove(movedBall) {\r\n        cc.log(\"cancel move ball:\" + movedBall);\r\n        var ball = cc.find(\"Canvas/GameCore/\" + movedBall);\r\n        for (var j = 0; j < this.AllPans.length; j++) {\r\n            //判断所有未装球的盘\r\n            // cc.log(\"Pan:\" + this.PlacedPans);\r\n            var tmpJ = this.PlacedPans.indexOf(j.toString());\r\n            if (tmpJ == -1) {\r\n                var dist = Math.floor(Math.sqrt(Math.pow(ball.x - this.AllPans[j].x, 2) + Math.pow(ball.y - this.AllPans[j].y, 2)));//判断距离\r\n                // cc.log(\"i:\" + i + \" j:\" + j + \" dist:\" + dist + \" pDist\" + this.PinchDistance);\r\n                if (dist <= this.PinchDistance) {\r\n                    var i = movedBall.substr(movedBall.length - 1, 1);\r\n                    this.PlacedBalls.push(i);\r\n                    this.PlacedPans.push(j.toString());\r\n                    cc.log(\"i:\" + i + \" j:\" + j + \" Dist:\" + dist);\r\n                    // this.AllBalls[i].getComponent(GameDragMove).enabled = false;\r\n                    this.TouchableBalls = this.TouchableBalls.replace(movedBall, \"\");\r\n                    var bm = cc.moveTo(0.2, this.AllPans[j].position);\r\n                    this.SoundMGR.playBlob();\r\n                    ball.runAction(bm);\r\n                    if (i <= 3) {\r\n                        this.BlueCount += 1;\r\n                    }\r\n                    else {\r\n                        this.RedCount += 1;\r\n                    }\r\n                    if (this.RedCount >= 4) {\r\n                        this.ShowResult(0);\r\n                    }\r\n                    else if (this.BlueCount >= 4) {\r\n                        this.ShowResult(1);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    ShowResult(winner) {\r\n        this.TouchableBalls = \"\";\r\n        this.GameStatus = 2;\r\n        this.SoundMGR.playOver();\r\n        this.scheduleOnce(function () {\r\n            if (winner == 0) {\r\n\r\n                for (var i = 0; i < this.PlacedBalls.length; i++) {\r\n                    if (this.PlacedBalls[i] >= 4) {\r\n                        var sa = cc.scaleTo(0.7, 1, 1);\r\n                        var sr = cc.rotateBy(0.7, 360);\r\n                        cc.find(\"Canvas/GameCore/\" + this.PlacedBalls[i]).runAction(sa);\r\n                        cc.find(\"Canvas/GameCore/\" + this.PlacedBalls[i]).runAction(sr);\r\n                    }\r\n\r\n                }\r\n                this.scheduleOnce(function () {\r\n                    Global.GameData.CurrentWinner = 0;\r\n                    this.GameResultNode.active = true;\r\n                }, 2);\r\n            }\r\n\r\n            else if (winner == 1) {\r\n                for (var i = 0; i < this.PlacedBalls.length; i++) {\r\n                    if (this.PlacedBalls[i] <= 3) {\r\n                        var sa = cc.scaleTo(0.7, 1, 1);\r\n                        var sr = cc.rotateBy(0.7, 360);\r\n                        cc.find(\"Canvas/GameCore/\" + this.PlacedBalls[i]).runAction(sa);\r\n                        cc.find(\"Canvas/GameCore/\" + this.PlacedBalls[i]).runAction(sr);\r\n                    }\r\n\r\n                }\r\n                this.scheduleOnce(function () {\r\n                    Global.GameData.CurrentWinner = 1;\r\n                    this.GameResultNode.active = true;\r\n                }, 2);\r\n\r\n            }\r\n        }, 0.5)\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}