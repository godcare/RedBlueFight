{"version":3,"sources":["Game23Control.js"],"names":["MySpriteNumber","require","SoundManager","cc","Class","extends","Component","properties","SoundMGR","default","type","GameResultNode","Node","CountDownNode","PauseNode","GameStatus","BallParent","UpBtn","DownBtn","Ship","ballSprites","SpriteFrame","redScoreLabel","blueScoreLabel","moveSpeed","currentScore","coinRate","onLoad","director","getPhysicsManager","enabled","onShipMoveClick","event","customEventData","y","playPop","start","startAnimation","i","setBall","getComponent","Button","color","Color","GRAY","scheduleOnce","active","WHITE","ballIndex","isNewSpawn","activeCount","find","tmpr","Math","random","nIndex","x","obj","tmp","Sprite","spriteFrame","tmpR","update","dt","log","setNumber","floor","node","hitObj","position","sub","mag","name","playScore","playOver","schedule","Global","GameData","CurrentCopScore","CurrentCopHistoryScore","CopHistoryScore","SaveCache"],"mappings":"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","file":"Game23Control.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Game23","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar MySpriteNumber = require(\"MySpriteNumber\");\r\nvar SoundManager = require(\"SoundManager\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        SoundMGR:\r\n        {\r\n            default: null,\r\n            type: SoundManager,\r\n        },\r\n        GameResultNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        CountDownNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        PauseNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GameStatus: 0,\r\n\r\n        BallParent:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        UpBtn:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        DownBtn:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        Ship:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        ballSprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n\r\n        redScoreLabel:\r\n        {\r\n            default: null,\r\n            type: MySpriteNumber,\r\n        },\r\n        blueScoreLabel:\r\n        {\r\n            default: null,\r\n            type: MySpriteNumber,\r\n        },\r\n\r\n        moveSpeed: 1,\r\n        currentScore: 0,\r\n        coinRate: 0.2,//刷金币的概率\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        cc.director.getPhysicsManager().enabled = true;\r\n\r\n    },\r\n\r\n    onShipMoveClick(event, customEventData) {\r\n        if (this.GameStatus == 1) {\r\n            if (customEventData == \"up\") {\r\n                if (this.Ship.y < 175) {\r\n                    this.Ship.y += 175;\r\n                    this.SoundMGR.playPop();\r\n                }\r\n\r\n            }\r\n            else {\r\n                if (this.Ship.y > -175) {\r\n                    this.Ship.y -= 175\r\n                    this.SoundMGR.playPop();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    start() {\r\n        this.startAnimation();\r\n    },\r\n    startAnimation() {\r\n        for (var i = 0; i < 5; i++) {\r\n            this.setBall(i, 1);\r\n        }\r\n        this.UpBtn.getComponent(cc.Button).enabled = false;\r\n        this.DownBtn.getComponent(cc.Button).enabled = false;\r\n        this.UpBtn.color = cc.Color.GRAY;\r\n        this.DownBtn.color = cc.Color.GRAY;\r\n        this.scheduleOnce(function () {\r\n            this.CountDownNode.active = true;\r\n        }, 0.5)\r\n        this.scheduleOnce(function () {\r\n            this.GameStatus = 1;\r\n            this.PauseNode.active = true;\r\n            this.UpBtn.getComponent(cc.Button).enabled = true;\r\n            this.DownBtn.getComponent(cc.Button).enabled = true;\r\n            this.UpBtn.color = cc.Color.WHITE;\r\n            this.DownBtn.color = cc.Color.WHITE;\r\n        }, 4.5);\r\n\r\n    },\r\n\r\n\r\n    setBall(ballIndex, isNewSpawn) {\r\n        var activeCount = 0;\r\n        //同一个竖线上最多同时存在两个\r\n        if (ballIndex < 3) {\r\n            for (var i = 0; i < 3; i++) {\r\n                if (cc.find(\"b\" + i, this.BallParent).active) {\r\n                    activeCount += 1;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 3; i < 6; i++) {\r\n                if (cc.find(\"b\" + i, this.BallParent).active) {\r\n                    activeCount += 1;\r\n                }\r\n            }\r\n        }\r\n        var tmpr = (Math.random() * 2 - 1) * 20;\r\n        var nIndex = (ballIndex + 3) % 6;\r\n        if (isNewSpawn == 0) {\r\n            cc.find(\"b\" + ballIndex, this.BallParent).x = cc.find(\"b\" + nIndex, this.BallParent).x + 420 + tmpr;\r\n        }\r\n        else {\r\n            cc.find(\"b\" + ballIndex, this.BallParent).x += tmpr;\r\n        }\r\n        if (activeCount == 0) {\r\n            var obj = cc.find(\"b\" + ballIndex, this.BallParent);\r\n            var tmp = Math.random();\r\n            if (tmp <= this.coinRate) {\r\n                obj.getComponent(cc.Sprite).spriteFrame = this.ballSprites[0];\r\n            }\r\n            else {\r\n                obj.getComponent(cc.Sprite).spriteFrame = this.ballSprites[1];\r\n            }\r\n\r\n            obj.active = true;\r\n        }\r\n        else if (activeCount == 1) {\r\n            var tmpR = Math.random();\r\n            if (tmpR <= 0.5) {\r\n                var obj = cc.find(\"b\" + ballIndex, this.BallParent);\r\n                var tmp = Math.random();\r\n                if (tmp <= this.coinRate) {\r\n                    obj.getComponent(cc.Sprite).spriteFrame = this.ballSprites[0];\r\n                }\r\n                else {\r\n                    obj.getComponent(cc.Sprite).spriteFrame = this.ballSprites[1];\r\n                }\r\n\r\n                obj.active = true;\r\n            }\r\n            else {\r\n\r\n                var obj = cc.find(\"b\" + ballIndex, this.BallParent).active = false;\r\n            }\r\n\r\n        }\r\n        else {\r\n            var obj = cc.find(\"b\" + ballIndex, this.BallParent).active = false;\r\n        }\r\n    },\r\n\r\n\r\n\r\n    update(dt) {\r\n        if (this.GameStatus == 1) {\r\n            //update timer\r\n\r\n\r\n\r\n            for (var i = 0; i < 6; i++) {\r\n\r\n                if (cc.find(\"b\" + i, this.BallParent).x <= -400) {\r\n                    if (cc.find(\"b\" + i, this.BallParent).active) {\r\n                        // cc.find(\"b\" + i, this.BallParent).active = false;\r\n                        if (cc.find(\"b\" + i, this.BallParent).getComponent(cc.Sprite).spriteFrame != this.ballSprites[0]) {\r\n                            this.currentScore += 1;\r\n                            cc.log(i + \" score\" + \" x:\" + (cc.find(\"b\" + i, this.BallParent).x));\r\n                            this.redScoreLabel.setNumber(this.currentScore);\r\n                            this.blueScoreLabel.setNumber(this.currentScore);\r\n                            this.moveSpeed = 200 + Math.floor((this.currentScore / 10)) * 40;\r\n                            if (this.currentScore > 99) {\r\n                                this.redScoreLabel.node.x = 370;\r\n                                this.blueScoreLabel.node.x = 370;\r\n                            }\r\n                            else {\r\n                                this.redScoreLabel.node.x = 325;\r\n                                this.blueScoreLabel.node.x = 325;\r\n                            }\r\n                        }\r\n                    }\r\n                    cc.find(\"b\" + i, this.BallParent).active = false;\r\n                    this.setBall(i, 0);\r\n                }\r\n                else {\r\n                    if (cc.find(\"b\" + i, this.BallParent).active) {\r\n                        var hitObj = cc.find(\"b\" + i, this.BallParent);\r\n                        if (hitObj.position.sub(this.Ship.position).mag() <= 100 && hitObj.active) {//判断距离\r\n                            if (hitObj.getComponent(cc.Sprite).spriteFrame == this.ballSprites[0])//hit coin\r\n                            {\r\n                                this.currentScore += 1;\r\n                                cc.log(hitObj.name + \" coin score\" + \" x:\" + hitObj.x);\r\n                                this.redScoreLabel.setNumber(this.currentScore);\r\n                                this.blueScoreLabel.setNumber(this.currentScore);\r\n                                this.moveSpeed = 200 + Math.floor((this.currentScore / 10)) * 40;\r\n                                this.SoundMGR.playScore();\r\n                                // hitObj.x = 350 + tmpr;\r\n                                hitObj.active = false;\r\n                                // var tmpr = (Math.random() * 2 - 1) * 20;\r\n                                // \r\n                                if (this.currentScore > 99) {\r\n                                    this.redScoreLabel.node.x = 370;\r\n                                    this.blueScoreLabel.node.x = 370;\r\n                                    cc.log(\"changing score pos x when >= 100\");\r\n                                }\r\n                                else {\r\n                                    this.redScoreLabel.node.x = 325;\r\n                                    this.blueScoreLabel.node.x = 325;\r\n                                    cc.log(\"changing score pos x when < 100\");\r\n                                }\r\n                                this.setBall(i, 0);\r\n\r\n\r\n                            }\r\n                            else {// game over\r\n                                this.GameStatus = 2;\r\n                                this.SoundMGR.playOver();\r\n                                this.schedule(function () {\r\n                                    this.Ship.active = !this.Ship.active;\r\n                                }, 0.3);\r\n                                Global.GameData.CurrentCopScore = this.currentScore;\r\n                                Global.GameData.CurrentCopHistoryScore = Global.GameData.CopHistoryScore[1];\r\n\r\n                                if (this.currentScore > Global.GameData.CurrentCopHistoryScore) {\r\n                                    Global.GameData.CurrentCopHistoryScore = this.currentScore;\r\n                                    Global.GameData.CopHistoryScore[1] = this.currentScore;\r\n                                    Global.GameData.SaveCache();\r\n                                }\r\n                                this.scheduleOnce(function () {\r\n\r\n                                    this.GameResultNode.active = true;\r\n                                }, 1.5);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                cc.find(\"b\" + i, this.BallParent).x -= this.moveSpeed * dt;\r\n            }\r\n        }\r\n    },\r\n});\r\n"]}