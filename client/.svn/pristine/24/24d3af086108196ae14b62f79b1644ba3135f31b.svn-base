{"version":3,"sources":["Game2Control.js"],"names":["blueDragMove","require","redDragMove","cc","Class","extends","Component","properties","GameResultNode","default","type","Node","CountDownNode","PauseNode","RedPlayer","BluePlayer","GameStatus","RedEnemySprites","SpriteFrame","BlueEnemySprites","AllBlues","AllReds","RedEnemy","BlueEnemy","xLimit","yLimit","MaxEnemyCount","RedEnemyCount","BlueEnemyCount","onLoad","director","getPhysicsManager","enabled","update","forEach","element","y","x","active","splice","indexOf","destoryEnemy","spawnEnemy","start","startAnimation","scheduleOnce","getComponent","schedule","BallHit","HitPlayer","HitName","sa","scaleTo","aa","fadeOut","runAction","Global","GameData","CurrentWinner","eType","newObj","instantiate","log","rs","Math","random","rsy","rss","floor","name","setPosition","abs","RigidBody","linearVelocity","Vec2","Sprite","spriteFrame","parent","find","node","push","targetEnemy","destroy"],"mappings":"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","file":"Game2Control.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Game2","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar blueDragMove = require(\"Game2DragMoveBlue\");\r\nvar redDragMove = require(\"Game2DragMoveRed\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        GameResultNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        CountDownNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        PauseNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        RedPlayer:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BluePlayer:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GameStatus: 0,//0未开始，1开始了，2结束了\r\n        RedEnemySprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        BlueEnemySprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        AllBlues:\r\n        {\r\n            default: [],\r\n            type: [cc.Node],\r\n        },\r\n        AllReds:\r\n        {\r\n            default: [],\r\n            type: [cc.Node],\r\n        },\r\n        RedEnemy:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BlueEnemy:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        xLimit: 0,\r\n        yLimit: 0,\r\n        MaxEnemyCount: 0,\r\n        RedEnemyCount: 0,\r\n        BlueEnemyCount: 0,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    onLoad() {\r\n        cc.director.getPhysicsManager().enabled = true;\r\n\r\n    },\r\n    update() {\r\n        if (this.GameStatus == 1) {\r\n            if (this.BlueEnemyCount > 0) {\r\n                this.AllBlues.forEach(element => {\r\n                    if (element.y <= 30 || element.y >= this.yLimit || element.x <= -this.xLimit || element.x >= this.xLimit) {\r\n                        element.active = false;\r\n                        this.AllBlues.splice(this.AllBlues.indexOf(element), 1);\r\n                        this.destoryEnemy(element);\r\n                        this.spawnEnemy(1);\r\n                    }\r\n\r\n                });\r\n            }\r\n            if (this.RedEnemyCount > 0) {\r\n                this.AllReds.forEach(element => {\r\n                    if (element.y >= -30 || element.y <= -this.yLimit || element.x <= -this.xLimit || element.x >= this.xLimit) {\r\n                        element.active = false;\r\n                        this.AllReds.splice(this.AllReds.indexOf(element), 1);\r\n                        this.destoryEnemy(element);\r\n                        this.spawnEnemy(0);\r\n                    }\r\n\r\n                });\r\n            }\r\n\r\n\r\n        }\r\n    },\r\n    start() {\r\n        this.startAnimation();\r\n    },\r\n    startAnimation() {\r\n        this.scheduleOnce(function () {\r\n            this.CountDownNode.active = true;\r\n        }, 0.5)\r\n        this.scheduleOnce(function () {\r\n            this.RedPlayer.getComponent(redDragMove).enabled = true;\r\n            this.BluePlayer.getComponent(blueDragMove).enabled = true;\r\n            this.GameStatus = 1;\r\n            this.PauseNode.active = true;\r\n\r\n        }, 3.5);\r\n        this.schedule(function () {\r\n            this.spawnEnemy(0);\r\n            this.spawnEnemy(1);\r\n        }, 3, 6, 4, true);\r\n\r\n    },\r\n\r\n    BallHit(HitPlayer, HitName) {\r\n        if (this.GameStatus == 1) {\r\n            if (HitPlayer == \"RedPlayer\") {\r\n                if (HitName == \"Red\")//红色撞了\r\n                {\r\n                    this.GameStatus = 2;\r\n                    this.RedPlayer.getComponent(redDragMove).enabled = false;\r\n                    this.BluePlayer.getComponent(blueDragMove).enabled = false;\r\n                    var sa = cc.scaleTo(1, 3, 3);\r\n                    var aa = cc.fadeOut(1);\r\n                    this.RedPlayer.runAction(sa);\r\n                    this.RedPlayer.runAction(aa);\r\n                    this.scheduleOnce(function () {\r\n\r\n                        Global.GameData.CurrentWinner = 1;\r\n                        this.GameResultNode.active = true;\r\n                    }, 1.5);\r\n                }\r\n            }\r\n            else if (HitPlayer == \"BluePlayer\") {\r\n                if (HitName == \"Blue\")//蓝色撞了\r\n                {\r\n                    this.GameStatus = 2;\r\n                    this.RedPlayer.getComponent(redDragMove).enabled = false;\r\n                    this.BluePlayer.getComponent(blueDragMove).enabled = false;\r\n                    var sa = cc.scaleTo(1, 3, 3);\r\n                    var aa = cc.fadeOut(1);\r\n                    this.BluePlayer.runAction(sa);\r\n                    this.BluePlayer.runAction(aa);\r\n                    this.scheduleOnce(function () {\r\n\r\n                        Global.GameData.CurrentWinner = 0;\r\n                        this.GameResultNode.active = true;\r\n                    }, 1.5);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    //eType=0,生成红色敌人,1生成蓝色敌人\r\n    spawnEnemy(eType) {\r\n        if (eType == 0) {\r\n            if (this.RedEnemyCount < this.MaxEnemyCount) {\r\n                var newObj = cc.instantiate(this.RedEnemy);\r\n                cc.log(\"Math Random\");\r\n                var rs = (Math.random() - 0.5) * 2;\r\n                var rsy = (Math.random() - 0.5) * 2;\r\n                var rss = Math.floor(Math.random() * 6);\r\n\r\n                newObj.active = true;\r\n                newObj.name = \"Red\";\r\n                newObj.setPosition(400 * rs, -100 * Math.abs(rs) - 500, 0);\r\n                newObj.getComponent(cc.RigidBody).linearVelocity = new cc.Vec2(-600 * rs, -300 * rsy);\r\n                newObj.getComponent(cc.Sprite).spriteFrame = this.RedEnemySprites[rss];\r\n                newObj.parent = cc.find(\"GameCore\", this.node);\r\n\r\n                this.AllReds.push(newObj);\r\n                this.RedEnemyCount += 1;\r\n            }\r\n        }\r\n        else {\r\n            if (this.BlueEnemyCount < this.MaxEnemyCount) {\r\n                var newObj = cc.instantiate(this.BlueEnemy);\r\n                var rs = (Math.random() - 0.5) * 2;\r\n                var rsy = (Math.random() - 0.5) * 2;\r\n                var rss = Math.floor(Math.random() * 6);\r\n\r\n                newObj.active = true;\r\n                newObj.name = \"Blue\";\r\n                newObj.setPosition(400 * rs, 100 * Math.abs(rs) + 500, 0);\r\n                newObj.getComponent(cc.RigidBody).linearVelocity = new cc.Vec2(-600 * rs, -300 * rsy);\r\n                newObj.getComponent(cc.Sprite).spriteFrame = this.BlueEnemySprites[rss];\r\n                newObj.parent = cc.find(\"GameCore\", this.node);\r\n\r\n                this.AllBlues.push(newObj);\r\n                this.BlueEnemyCount += 1;\r\n            }\r\n        }\r\n    },\r\n    destoryEnemy(targetEnemy) {\r\n        if (targetEnemy.name == \"Blue\") {\r\n            targetEnemy.destroy();\r\n            this.BlueEnemyCount -= 1;\r\n        }\r\n        else {\r\n            targetEnemy.destroy();\r\n            this.RedEnemyCount -= 1;\r\n        }\r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}