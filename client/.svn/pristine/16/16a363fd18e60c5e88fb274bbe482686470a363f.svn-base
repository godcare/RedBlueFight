{"version":3,"sources":["GameResultControl.js"],"names":["cc","Class","extends","Component","properties","MaxRound","Winner","LevelIndex","ShowPlayerY","ShowOpY","RedPlayer","default","type","Node","BluePlayer","BlueSprites","SpriteFrame","RedSprites","ResultSprites","NextSprites","RedOp","BlueOp","redGraphics","Graphics","blueGraphics","LoadingObj","start","startAnimation","Global","GameData","CurrentWinner","PlayedGameCount","log","circle","width","fillColor","Color","fill","find","getComponent","Sprite","spriteFrame","RedPoint","BluePoint","ResultArray","length","TotalGameCount","Button","enabled","push","currentPanel","node","getChildByName","toString","active","blueMoveAction","moveTo","runAction","redMoveAction","IsPlayForFun","bOpMoveAction","rOpMoveAction","i","OnMainClick","event","customEventData","director","loadScene","OnReplayClick","LastSceneName","OnNextClick","showLoading","MaxSchedulerCount","ScheduledGames","ra","rotateBy"],"mappings":"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","file":"GameResultControl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Common","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        MaxRound: 3,\r\n        Winner: 0,//胜者，0-红，1-蓝，-1-无\r\n        LevelIndex: 0,//下一关序号\r\n        ShowPlayerY: 450,//展示时的Y轴坐标\r\n        ShowOpY: 375,//菜单Y轴\r\n        RedPlayer:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BluePlayer:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BlueSprites://第一张失败，第二张胜利\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        RedSprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        ResultSprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        NextSprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        RedOp:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BlueOp:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        redGraphics:\r\n        {\r\n            default: null,\r\n            type: cc.Graphics,\r\n        },\r\n        blueGraphics:\r\n        {\r\n            default: null,\r\n            type: cc.Graphics,\r\n        },\r\n        LoadingObj:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        this.startAnimation();\r\n    },\r\n\r\n    startAnimation() {\r\n        this.Winner = Global.GameData.CurrentWinner;\r\n        Global.GameData.PlayedGameCount += 1;\r\n        cc.log(\"Current Winner:\" + this.Winner);\r\n\r\n        this.redGraphics.circle(0, 0, this.RedPlayer.width / 2 + 0.5);\r\n        this.redGraphics.fillColor = new cc.Color(234, 53, 74, 255);\r\n        this.redGraphics.fill();\r\n        this.blueGraphics.circle(0, 0, this.BluePlayer.width / 2 + 0.5);\r\n        this.blueGraphics.fillColor = new cc.Color(42, 143, 228, 255);\r\n        this.blueGraphics.fill();\r\n\r\n        if (this.Winner == 0) {//red win\r\n            cc.find(\"Player\", this.RedPlayer).getComponent(cc.Sprite).spriteFrame = this.RedSprites[1];\r\n            cc.find(\"Player\", this.BluePlayer).getComponent(cc.Sprite).spriteFrame = this.BlueSprites[0];\r\n            Global.GameData.RedPoint += 1;\r\n        }\r\n        else if (this.Winner == 1) {//blue win\r\n            cc.find(\"Player\", this.RedPlayer).getComponent(cc.Sprite).spriteFrame = this.RedSprites[0];\r\n            cc.find(\"Player\", this.BluePlayer).getComponent(cc.Sprite).spriteFrame = this.BlueSprites[1];\r\n            Global.GameData.BluePoint += 1;\r\n        }\r\n        else {\r\n            cc.find(\"Player\", this.RedPlayer).getComponent(cc.Sprite).spriteFrame = this.RedSprites[0];\r\n            cc.find(\"Player\", this.BluePlayer).getComponent(cc.Sprite).spriteFrame = this.BlueSprites[1];\r\n\r\n        }\r\n        if (Global.GameData.ResultArray.length >= Global.GameData.TotalGameCount) {\r\n            Global.GameData.ResultArray = [];\r\n        }\r\n        if (Global.GameData.PlayedGameCount >= Global.GameData.TotalGameCount) {\r\n            cc.find(\"BtnNext\", this.RedOp).getComponent(cc.Button).enabled = false;\r\n            cc.find(\"BtnNext\", this.RedOp).getComponent(cc.Sprite).spriteFrame = this.NextSprites[1];\r\n            cc.find(\"BtnNext\", this.BlueOp).getComponent(cc.Button).enabled = false;\r\n            cc.find(\"BtnNext\", this.BlueOp).getComponent(cc.Sprite).spriteFrame = this.NextSprites[1];\r\n\r\n        }\r\n        else {\r\n            cc.find(\"BtnNext\", this.RedOp).getComponent(cc.Button).enabled = true;\r\n            cc.find(\"BtnNext\", this.RedOp).getComponent(cc.Sprite).spriteFrame = this.NextSprites[0];\r\n            cc.find(\"BtnNext\", this.BlueOp).getComponent(cc.Button).enabled = true;\r\n            cc.find(\"BtnNext\", this.BlueOp).getComponent(cc.Sprite).spriteFrame = this.NextSprites[0];\r\n        }\r\n\r\n        Global.GameData.ResultArray.push(this.Winner);\r\n        var currentPanel = this.node.getChildByName(\"ScoreWhen\" + Global.GameData.TotalGameCount.toString());\r\n        currentPanel.active = true;\r\n        var blueMoveAction = cc.moveTo(0.5, 0, this.ShowPlayerY);\r\n        this.BluePlayer.runAction(blueMoveAction);\r\n        var redMoveAction = cc.moveTo(0.5, 0, -this.ShowPlayerY);\r\n        this.RedPlayer.runAction(redMoveAction);\r\n\r\n        cc.find(\"BtnNext\", this.RedOp).active = !Global.GameData.IsPlayForFun;\r\n        cc.find(\"BtnReplay\", this.RedOp).active = Global.GameData.IsPlayForFun;\r\n        cc.find(\"BtnNext\", this.BlueOp).active = !Global.GameData.IsPlayForFun;\r\n        cc.find(\"BtnReplay\", this.BlueOp).active = Global.GameData.IsPlayForFun;\r\n\r\n        var bOpMoveAction = cc.moveTo(1, 0, this.ShowOpY);\r\n        this.BlueOp.runAction(bOpMoveAction);\r\n        var rOpMoveAction = cc.moveTo(1, 0, -this.ShowOpY);\r\n        this.RedOp.runAction(rOpMoveAction);\r\n\r\n        for (var i = 0; i < Global.GameData.ResultArray.length; i++) {\r\n            cc.find(i.toString(), currentPanel).getComponent(cc.Sprite).spriteFrame = this.ResultSprites[Global.GameData.ResultArray[i]];\r\n        }\r\n    },\r\n\r\n    OnMainClick(event, customEventData) {\r\n        cc.director.loadScene(\"MainMenu\");\r\n    },\r\n\r\n    OnReplayClick(event, customEventData) {\r\n        cc.director.loadScene(Global.GameData.LastSceneName);\r\n    },\r\n\r\n    OnNextClick(event, customEventData) {\r\n        this.showLoading();\r\n        cc.log(\"played:\" + Global.GameData.PlayedGameCount + \" max scheduler:\" + Global.GameData.MaxSchedulerCount);\r\n        if (Global.GameData.PlayedGameCount < Global.GameData.MaxSchedulerCount) {\r\n            cc.director.loadScene(\"GameScene\" + Global.GameData.ScheduledGames[Global.GameData.PlayedGameCount.toString()]);\r\n        }\r\n    },\r\n\r\n    showLoading() {\r\n        this.LoadingObj.active = true;\r\n        var ra = cc.rotateBy(100, 36000);\r\n        cc.find(\"LoadingCircle\", this.LoadingObj).runAction(ra);\r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}