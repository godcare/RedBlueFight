{"version":3,"sources":["Game12Control.js"],"names":["SoundManager","require","cc","Class","extends","Component","properties","SoundMGR","default","type","GameResultNode","Node","CountDownNode","PauseNode","GameStatus","redCount","blueCount","panParent","virusSprites","SpriteFrame","UnColoredList","TotalSeconds","tmpTimer","redProgress","ProgressBar","blueProgress","start","startAnimation","update","dt","progress","i","find","toString","getComponent","Button","enabled","playOver","scheduleOnce","Global","GameData","CurrentWinner","active","push","initViruses","tmpr","Math","floor","random","length","initColor","tmpc","splice","onPanClick","event","customEventData","changeColor","pIndex","cIndex","Sprite","spriteFrame","rotation","playBlob"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,eAAeC,QAAQ,cAAR,CAAnB;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,kBACA;AACIC,qBAAS,IADb;AAEIC,kBAAMT;AAFV,SAjBQ;AAqBRU,wBACA;AACIF,qBAAS,IADb;AAEIC,kBAAMP,GAAGS;AAFb,SAtBQ;AA0BRC,uBACA;AACIJ,qBAAS,IADb;AAEIC,kBAAMP,GAAGS;AAFb,SA3BQ;AA+BRE,mBACA;AACIL,qBAAS,IADb;AAEIC,kBAAMP,GAAGS;AAFb,SAhCQ;AAoCRG,oBAAY,CApCJ,EAoCM;AACdC,kBAAU,CArCF;AAsCRC,mBAAW,CAtCH;AAuCRC,mBACA;AACIT,qBAAS,IADb;AAEIC,kBAAMP,GAAGS;AAFb,SAxCQ;AA4CRO,sBACA;AACIV,qBAAS,EADb;AAEIC,kBAAM,CAACP,GAAGiB,WAAJ;AAFV,SA7CQ;AAiDRC,uBAAe,EAjDP;AAkDRC,sBAAc,EAlDN;AAmDRC,kBAAU,CAnDF;AAoDRC,qBACA;AACIf,qBAAS,IADb;AAEIC,kBAAMP,GAAGsB;AAFb,SArDQ;AAyDRC,sBACA;AACIjB,qBAAS,IADb;AAEIC,kBAAMP,GAAGsB;AAFb;AA1DQ,KAHP;;AAmEL;;AAEA;;AAEAE,SAvEK,mBAuEG;AACJ;AACA,aAAKC,cAAL;AAEH,KA3EI;AA6ELC,UA7EK,kBA6EEC,EA7EF,EA6EM;AACP,YAAI,KAAKf,UAAL,IAAmB,CAAvB,EAA0B;AACtB,gBAAI,KAAKQ,QAAL,IAAiB,KAAKD,YAA1B,EAAwC;AACpC,qBAAKC,QAAL,IAAiBO,EAAjB;AACA,qBAAKN,WAAL,CAAiBO,QAAjB,GAA4B,CAAC,KAAKT,YAAL,GAAoB,KAAKC,QAA1B,IAAsC,KAAKD,YAAvE;AACA,qBAAKI,YAAL,CAAkBK,QAAlB,GAA6B,CAAC,KAAKT,YAAL,GAAoB,KAAKC,QAA1B,IAAsC,KAAKD,YAAxE;AACH,aAJD,MAKK;AACD,qBAAKP,UAAL,GAAkB,CAAlB;AACA,qBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzB7B,uBAAG8B,IAAH,CAAQD,EAAEE,QAAF,EAAR,EAAsB,KAAKhB,SAA3B,EAAsCiB,YAAtC,CAAmDhC,GAAGiC,MAAtD,EAA8DC,OAA9D,GAAwE,KAAxE;AAEH;AACD,oBAAI,KAAKrB,QAAL,GAAgB,KAAKC,SAAzB,EAAoC;AAChC,yBAAKT,QAAL,CAAc8B,QAAd;AACA,yBAAKC,YAAL,CAAkB,YAAY;AAC1BC,+BAAOC,QAAP,CAAgBC,aAAhB,GAAgC,CAAhC;AACA,6BAAK/B,cAAL,CAAoBgC,MAApB,GAA6B,IAA7B;AACH,qBAHD,EAGG,CAHH;AAIH,iBAND,MAOK;AACD,yBAAKnC,QAAL,CAAc8B,QAAd;AACA,yBAAKC,YAAL,CAAkB,YAAY;AAC1BC,+BAAOC,QAAP,CAAgBC,aAAhB,GAAgC,CAAhC;AACA,6BAAK/B,cAAL,CAAoBgC,MAApB,GAA6B,IAA7B;AACH,qBAHD,EAGG,CAHH;AAIH;AACJ;AACJ;AACJ,KA1GI;AA4GLf,kBA5GK,4BA4GY;AACb,aAAK,IAAII,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzB7B,eAAG8B,IAAH,CAAQD,EAAEE,QAAF,EAAR,EAAsB,KAAKhB,SAA3B,EAAsCiB,YAAtC,CAAmDhC,GAAGiC,MAAtD,EAA8DC,OAA9D,GAAwE,KAAxE;AACA,iBAAKhB,aAAL,CAAmBuB,IAAnB,CAAwBZ,EAAEE,QAAF,EAAxB;AACH;AACD,aAAKK,YAAL,CAAkB,YAAY;AAC1B,iBAAK1B,aAAL,CAAmB8B,MAAnB,GAA4B,IAA5B;AACH,SAFD,EAEG,GAFH;AAGA,aAAKJ,YAAL,CAAkB,YAAY;AAC1B,iBAAKM,WAAL;AACA,iBAAK9B,UAAL,GAAkB,CAAlB;AACA,iBAAKD,SAAL,CAAe6B,MAAf,GAAwB,IAAxB;AACA,iBAAK,IAAIX,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzB7B,mBAAG8B,IAAH,CAAQD,EAAEE,QAAF,EAAR,EAAsB,KAAKhB,SAA3B,EAAsCiB,YAAtC,CAAmDhC,GAAGiC,MAAtD,EAA8DC,OAA9D,GAAwE,IAAxE;AACH;AACJ,SAPD,EAOG,GAPH;AASH,KA7HI;AA+HLQ,eA/HK,yBA+HS;AACV,YAAIC,OAAO,CAAX;AACA,aAAK,IAAId,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzBc,mBAAOC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAK5B,aAAL,CAAmB6B,MAA9C,CAAP;AACA,gBAAIlB,IAAI,CAAR,EAAW;AAAC;AACR,qBAAKmB,SAAL,CAAe,KAAK9B,aAAL,CAAmByB,IAAnB,CAAf,EAAyC,CAAzC;AACH,aAFD,MAGK,IAAId,IAAI,EAAR,EAAY;AAAC;AACd,qBAAKmB,SAAL,CAAe,KAAK9B,aAAL,CAAmByB,IAAnB,CAAf,EAAyC,CAAzC;AACH,aAFI,MAGA,IAAId,KAAK,EAAT,EAAa;AAAC;AACf,oBAAIoB,OAAOL,KAAKE,MAAL,EAAX;AACA,oBAAIG,QAAQ,GAAZ,EAAiB;AACb,yBAAKD,SAAL,CAAe,KAAK9B,aAAL,CAAmB,CAAnB,CAAf,EAAsC,CAAtC;AACH,iBAFD,MAGK;AACD,yBAAK8B,SAAL,CAAe,KAAK9B,aAAL,CAAmB,CAAnB,CAAf,EAAsC,CAAtC;AACH;AACJ;AACD,iBAAKA,aAAL,CAAmBgC,MAAnB,CAA0BP,IAA1B,EAAgC,CAAhC;AACH;AACJ,KApJI;AAsJLQ,cAtJK,sBAsJMC,KAtJN,EAsJaC,eAtJb,EAsJ8B;AAC/B,aAAKC,WAAL,CAAiBD,eAAjB;AACH,KAxJI;AA2JLL,aA3JK,qBA2JKO,MA3JL,EA2JaC,MA3Jb,EA2JqB;AACtB,YAAIA,UAAU,CAAd,EAAgB;AAChB;AACIxD,mBAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,GAA4F,KAAK1C,YAAL,CAAkB,CAAlB,CAA5F;AACAhB,mBAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsD4C,QAAtD,GAAiE,CAAjE;AACA,qBAAK9C,QAAL,IAAiB,CAAjB;AACH,aALD,MAMK,IAAI2C,UAAU,CAAd,EAAgB;AACrB;AACIxD,mBAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,GAA4F,KAAK1C,YAAL,CAAkB,CAAlB,CAA5F;AACAhB,mBAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsD4C,QAAtD,GAAiE,GAAjE;AACA,qBAAK7C,SAAL,IAAkB,CAAlB;AACH;AAEJ,KAzKI;AA2KLwC,eA3KK,uBA2KOC,MA3KP,EA2Ke;AAChB,YAAIvD,GAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,IAA6F,KAAK1C,YAAL,CAAkB,CAAlB,CAAjG,EAAuH;AACnHhB,eAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,GAA4F,KAAK1C,YAAL,CAAkB,CAAlB,CAA5F;AACAhB,eAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsD4C,QAAtD,GAAiE,GAAjE;AACA,iBAAK9C,QAAL,IAAiB,CAAjB;AACA,iBAAKC,SAAL,IAAkB,CAAlB;AACA,iBAAKT,QAAL,CAAcuD,QAAd;AACH,SAND,MAOK,IAAI5D,GAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,IAA6F,KAAK1C,YAAL,CAAkB,CAAlB,CAAjG,EAAuH;AACxHhB,eAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsDiB,YAAtD,CAAmEhC,GAAGyD,MAAtE,EAA8EC,WAA9E,GAA4F,KAAK1C,YAAL,CAAkB,CAAlB,CAA5F;AACAhB,eAAG8B,IAAH,CAAQyB,OAAOxB,QAAP,KAAoB,QAA5B,EAAsC,KAAKhB,SAA3C,EAAsD4C,QAAtD,GAAiE,CAAjE;AACA,iBAAK9C,QAAL,IAAiB,CAAjB;AACA,iBAAKC,SAAL,IAAkB,CAAlB;AACA,iBAAKT,QAAL,CAAcuD,QAAd;AACH;AACD,YAAI,KAAK/C,QAAL,IAAiB,EAArB,EAAyB;AACrB,iBAAK,IAAIgB,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzB7B,mBAAG8B,IAAH,CAAQD,EAAEE,QAAF,EAAR,EAAsB,KAAKhB,SAA3B,EAAsCiB,YAAtC,CAAmDhC,GAAGiC,MAAtD,EAA8DC,OAA9D,GAAwE,KAAxE;AAEH;;AAED,iBAAK7B,QAAL,CAAc8B,QAAd;AACA,iBAAKC,YAAL,CAAkB,YAAY;AAC1BC,uBAAOC,QAAP,CAAgBC,aAAhB,GAAgC,CAAhC;AACA,qBAAK/B,cAAL,CAAoBgC,MAApB,GAA6B,IAA7B;AACH,aAHD,EAGG,CAHH;AAKH,SAZD,MAaK,IAAI,KAAK1B,SAAL,IAAkB,EAAtB,EAA0B;AAC3B,iBAAK,IAAIe,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AACzB7B,mBAAG8B,IAAH,CAAQD,EAAEE,QAAF,EAAR,EAAsB,KAAKhB,SAA3B,EAAsCiB,YAAtC,CAAmDhC,GAAGiC,MAAtD,EAA8DC,OAA9D,GAAwE,KAAxE;AAEH;;AAED,iBAAK7B,QAAL,CAAc8B,QAAd;AACA,iBAAKC,YAAL,CAAkB,YAAY;AAC1BC,uBAAOC,QAAP,CAAgBC,aAAhB,GAAgC,CAAhC;AACA,qBAAK/B,cAAL,CAAoBgC,MAApB,GAA6B,IAA7B;AACH,aAHD,EAGG,CAHH;AAIH;AACJ;AAnNI,CAAT","file":"Game12Control.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Scripts\\Control\\Games\\Game12","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar SoundManager = require(\"SoundManager\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        SoundMGR:\r\n        {\r\n            default: null,\r\n            type: SoundManager,\r\n        },\r\n        GameResultNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        CountDownNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        PauseNode:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GameStatus: 0,//0未开始，1开始了，2结束了\r\n        redCount: 0,\r\n        blueCount: 0,\r\n        panParent:\r\n        {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        virusSprites:\r\n        {\r\n            default: [],\r\n            type: [cc.SpriteFrame],\r\n        },\r\n        UnColoredList: [],\r\n        TotalSeconds: 12,\r\n        tmpTimer: 0,\r\n        redProgress:\r\n        {\r\n            default: null,\r\n            type: cc.ProgressBar,\r\n        },\r\n        blueProgress:\r\n        {\r\n            default: null,\r\n            type: cc.ProgressBar,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        // this.redScoreTotalNumber.setNumber(20);\r\n        this.startAnimation();\r\n\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.GameStatus == 1) {\r\n            if (this.tmpTimer <= this.TotalSeconds) {\r\n                this.tmpTimer += dt;\r\n                this.redProgress.progress = (this.TotalSeconds - this.tmpTimer) / this.TotalSeconds;\r\n                this.blueProgress.progress = (this.TotalSeconds - this.tmpTimer) / this.TotalSeconds;\r\n            }\r\n            else {\r\n                this.GameStatus = 2;\r\n                for (var i = 0; i < 13; i++) {\r\n                    cc.find(i.toString(), this.panParent).getComponent(cc.Button).enabled = false;\r\n\r\n                }\r\n                if (this.redCount > this.blueCount) {\r\n                    this.SoundMGR.playOver();\r\n                    this.scheduleOnce(function () {\r\n                        Global.GameData.CurrentWinner = 0;\r\n                        this.GameResultNode.active = true;\r\n                    }, 1);\r\n                }\r\n                else {\r\n                    this.SoundMGR.playOver();\r\n                    this.scheduleOnce(function () {\r\n                        Global.GameData.CurrentWinner = 0;\r\n                        this.GameResultNode.active = true;\r\n                    }, 1);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    startAnimation() {\r\n        for (var i = 0; i < 13; i++) {\r\n            cc.find(i.toString(), this.panParent).getComponent(cc.Button).enabled = false;\r\n            this.UnColoredList.push(i.toString());\r\n        }\r\n        this.scheduleOnce(function () {\r\n            this.CountDownNode.active = true;\r\n        }, 0.5)\r\n        this.scheduleOnce(function () {\r\n            this.initViruses();\r\n            this.GameStatus = 1;\r\n            this.PauseNode.active = true;\r\n            for (var i = 0; i < 13; i++) {\r\n                cc.find(i.toString(), this.panParent).getComponent(cc.Button).enabled = true;\r\n            }\r\n        }, 4.5);\r\n\r\n    },\r\n\r\n    initViruses() {\r\n        var tmpr = 0;\r\n        for (var i = 0; i < 13; i++) {\r\n            tmpr = Math.floor(Math.random() * this.UnColoredList.length);\r\n            if (i < 6) {//red\r\n                this.initColor(this.UnColoredList[tmpr], 0);\r\n            }\r\n            else if (i < 12) {//blue\r\n                this.initColor(this.UnColoredList[tmpr], 1);\r\n            }\r\n            else if (i == 12) {//random\r\n                var tmpc = Math.random();\r\n                if (tmpc <= 0.5) {\r\n                    this.initColor(this.UnColoredList[0], 0);\r\n                }\r\n                else {\r\n                    this.initColor(this.UnColoredList[0], 1);\r\n                }\r\n            }\r\n            this.UnColoredList.splice(tmpr, 1);\r\n        }\r\n    },\r\n\r\n    onPanClick(event, customEventData) {\r\n        this.changeColor(customEventData);\r\n    },\r\n\r\n\r\n    initColor(pIndex, cIndex) {\r\n        if (cIndex == 0)//init red\r\n        {\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame = this.virusSprites[0];\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).rotation = 0;\r\n            this.redCount += 1;\r\n        }\r\n        else if (cIndex == 1)//init blue\r\n        {\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame = this.virusSprites[1];\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).rotation = 180;\r\n            this.blueCount += 1;\r\n        }\r\n\r\n    },\r\n\r\n    changeColor(pIndex) {\r\n        if (cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame == this.virusSprites[0]) {\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame = this.virusSprites[1];\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).rotation = 180;\r\n            this.redCount -= 1;\r\n            this.blueCount += 1;\r\n            this.SoundMGR.playBlob();\r\n        }\r\n        else if (cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame == this.virusSprites[1]) {\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).getComponent(cc.Sprite).spriteFrame = this.virusSprites[0];\r\n            cc.find(pIndex.toString() + \"/virus\", this.panParent).rotation = 0;\r\n            this.redCount += 1;\r\n            this.blueCount -= 1;\r\n            this.SoundMGR.playBlob();\r\n        }\r\n        if (this.redCount == 13) {\r\n            for (var i = 0; i < 13; i++) {\r\n                cc.find(i.toString(), this.panParent).getComponent(cc.Button).enabled = false;\r\n\r\n            }\r\n\r\n            this.SoundMGR.playOver();\r\n            this.scheduleOnce(function () {\r\n                Global.GameData.CurrentWinner = 0;\r\n                this.GameResultNode.active = true;\r\n            }, 1);\r\n\r\n        }\r\n        else if (this.blueCount == 13) {\r\n            for (var i = 0; i < 13; i++) {\r\n                cc.find(i.toString(), this.panParent).getComponent(cc.Button).enabled = false;\r\n\r\n            }\r\n\r\n            this.SoundMGR.playOver();\r\n            this.scheduleOnce(function () {\r\n                Global.GameData.CurrentWinner = 0;\r\n                this.GameResultNode.active = true;\r\n            }, 1);\r\n        }\r\n    },\r\n});\r\n"]}